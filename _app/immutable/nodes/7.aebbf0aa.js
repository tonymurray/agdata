import{s as ye,n as X,o as ke}from"../chunks/scheduler.e108d1fd.js";import{S as we,i as xe,g as Y,s as oe,h as Z,c as le,x as Me,k as G,a as K,f as U}from"../chunks/index.5ae4157e.js";import{j as Ne}from"../chunks/jquery.5af47638.js";import{l as se}from"../chunks/loadscript.5be5f31a.js";function ze($){let s,h,e,m,z,q='<div id="bm-root" class="bm-wrapper" data-region-code="ssa-a"><div class="bm-header"><div class="bm-selector"><div class="bm-current-indicator default drupal" data-key="select-country"></div> <div id="indic-selector" class="bm-selector-list"></div></div> <div class="bm-selector"><div class="bm-current-country">Â </div> <div id="geo-selector" class="bm-selector-list"></div></div></div> <div class="bm-content svelte-yavuaz"><div id="ranking-container" class="svelte-yavuaz"><div id="ranking-title" class="bm-group-header drupal" data-key="ranking"></div> <div class="bm-sort-container"><div class="drupal" data-key="sort-by"></div> <input id="a-z" type="radio" name="sort" value="label"/><label for="a-z" class="drupal" data-key="a-z"></label> <div id="sort-numerics"></div></div> <div id="ranking" class="bm-ranking svelte-yavuaz"></div></div> <div class="bm-map svelte-yavuaz"><div id="map" class="svelte-yavuaz"></div></div> <div id="groups" class="bm-indicators svelte-yavuaz"><div class="bm-group"><div class="bm-group-header drupal svelte-yavuaz" data-key="g1-caption"></div> <div id="g1" class="bm-group-indicators"></div></div> <div class="bm-group"><div class="bm-group-header drupal svelte-yavuaz" data-key="g2-caption"></div> <div id="g2" class="bm-group-indicators"></div></div> <div class="drupal groups-description" data-empty="" data-key="groups-description"></div></div></div> <div class="bm-content svelte-yavuaz"><div class="bm-indicator-info svelte-yavuaz"><div class="bm-header drupal" data-key="indicator-info"></div> <div class="bm-indicator-title bm-subheader"></div> <div class="bm-indicator-description"></div> <div class="bm-disclaimer drupal disclaimer-note" data-key="disclaimer"></div></div> <div class="bm-data-download svelte-yavuaz"><div class="bm-header drupal" data-key="data"></div> <div class="data-download"><div class="bm-download-group"><input type="radio" id="d1-1" name="d1" checked=""/><label for="d1-1" id="l1-1"></label> <input type="radio" id="d1-2" name="d1"/><label class="drupal" data-key="all-indicators" for="d1-2"></label></div> <div class="bm-download-group"><input type="radio" id="d2-1" name="d2"/><label for="d2-1" id="l2-1"></label> <input type="radio" id="d2-2" name="d2" checked=""/><label class="drupal" data-key="all-countries" for="d2-2"></label></div> <div class="bt-download-buttons"><button id="data-download" class="bm-download-button drupal" data-key="download-excel"></button> <p class="bt-full-download drupal" data-key="download-tool"></p> <p class="bt-full-download"><a class="drupal" id="download-notes" data-key="download-notes"></a></p></div></div></div> <div class="bm-country-info svelte-yavuaz"><div id="country-page"><div class="bm-header drupal" data-key="country-page"></div> <div class="bm-country-page bm-subheader"></div> <div class="bm-country-page-note drupal" data-key="country-page-note"></div></div> <div id="country-note"><div class="bm-header drupal" data-key="country-note"></div> <div class="bm-country-note"></div></div></div></div></div>';return{c(){s=Y("link"),h=oe(),e=Y("link"),m=oe(),z=Y("div"),z.innerHTML=q,this.h()},l(u){s=Z(u,"LINK",{rel:!0,type:!0,href:!0}),h=le(u),e=Z(u,"LINK",{rel:!0,type:!0,href:!0}),m=le(u),z=Z(u,"DIV",{class:!0,"data-svelte-h":!0}),Me(z)!=="svelte-xf466l"&&(z.innerHTML=q),this.h()},h(){G(s,"rel","stylesheet"),G(s,"type","text/css"),G(s,"href","/benchmarking/benchmarktool.css"),G(e,"rel","stylesheet"),G(e,"type","text/css"),G(e,"href","/benchmarking/benchmarktool2.css"),G(z,"class","wrapper svelte-yavuaz")},m(u,g){K(u,s,g),K(u,h,g),K(u,e,g),K(u,m,g),K(u,z,g)},p:X,i:X,o:X,d(u){u&&(U(s),U(h),U(e),U(m),U(z))}}}function Ce($){const s={config:{iso3:"",lang:"en",root:"/",site:"/benchmarking/",file:"/",json:"/benchmarking/",benchmark_meta:"https://dataportal.asti.cgiar.org/json/benchmarking?region=ssa-a&lang=en",tool:"",path:"",legacyasti:"https://www.asti.cgiar.org/sites/all/libraries/mw",api:{public:{token:"public",url:"https://dataportal.asti.cgiar.org/api/public",language:"en",version:2}},map:{click:"https://www.asti.cgiar.org/{NAME}?country={ISO3}&lang={LANG}"}}};let h;return ke(async()=>{await se("/common/mw.js"),await se("/common/tinycolor.js"),Ne(document).ready(function(e){var m=s.config.iso3,z=s.config.lang,q=document.getElementById("bm-root").getAttribute("data-region-code"),u,g,y,S="value0",B=-1,Q=1,de=s.config.benchmarking&&s.config.benchmarking["dmp-override"]?s.config.benchmarking["dmp-override"]:{geoitems:{},indicators:{}},n=new mw.DataManager({data:de});function ce(i,a){return a.replace("{ISO3}",i).replace("{LANG}",z).replace("{NAME}",n.geoitems[i].url)}function ve(i){return i.indexOf("?")==-1,e.ajax({url:s.config.benchmark_meta,data:{}})}function ee(i,a,t){var v=a&&a.api?a.api:"public",l=mw.support.extend(s.config.api[v],{}),c=l.url;return delete l.url,a&&delete a.api,i=="/indicators/data"&&(navigator.userAgent.match(/Trident/g)||navigator.userAgent.match(/MSIE/g))&&(t="POST"),e.ajax({url:c+i,type:t||"GET",data:mw.support.extend(a||{},l),dataType:"json",error(x,b,j){console.log("ERROR "+c+i,b,j)}})}function ue(i){var a=n.geoitems[i];if(!a||a.type=="map-inactive")return"#ededed";if(a.type=="region-inactive"||!y||!y.current||y.current[i]==null)return"#d8d8d8";var t=y.current,v=y.min,l=y.max,c=(t[i]-v)/(l-v)-.5;return c>0?tinycolor(y.color).darken(20*c).toString():tinycolor(y.color).lighten(-40*c).toString()}function pe(i){var a=n.geoitems[i.geoitem];if(a&&a.type!="map-inactive"){var t='<div class="label">{GEOITEM}</div>';return y&&y.current[i.geoitem]!=null&&(t+='<div class="value">'+mw.support.format(y.format,y.current[i.geoitem])+"</div>"),t}else return!1}function ae(i){e("#bm-root").attr("data-country-code",i);var a=n.geoitems[i]||{};if(e(".bm-current-country").html(a.label||n.meta["select-country"]).toggleClass("default",!a.label),e("#l2-1").toggle(a.hasOwnProperty("label")).html(a.label),!a.hasOwnProperty("label")&&e("#l2-1").prev().prop("checked")&&e("#l2-1").next().prop("checked",!0),e(".rank-indicator").removeClass("selected"),e('.rank-indicator[code="'+i+'"]').addClass("selected"),e("#country-page").toggleClass("hidden",a.url==null||a.url==""),a.url!=null&&a.url!=""){var t='<a href="'+ce(i,s.config.map.click)+'">'+a.label+"</a>";e("#country-page .bm-subheader").html(t),e("#country-page .bm-country-page-note").html(n.meta["country-page-note"].replace("{CPURL}",t))}me(i),te(i)}function R(i,a){var t=n.indicators[i];if(e(".bm-current-indicator").html(t.grouplabel+" / "+t.label),e(".bm-indicator-title").html(t.label),e(".bm-indicator-description").html(t.description),!a){e(".group-indicator").removeClass("selected"),e('.group-indicator[code="'+i+'"]').addClass("selected"),e("#l1-1").html(t.label);for(var v="",l=0;l<t.siblings.length;l++)n.indicators[t.siblings[l]],v+='<input id="s123-'+l+'" type="radio" name="sort" value="value'+l+'"',S=="value"+l&&(v+=" checked"),v+='/><label for="s123-'+l+'">'+t.sort[l]+"</label>";e("#sort-numerics").html(v)}e("#ranking-container").attr("data-group",t.group),ie(i,a),te(m),y=t,h.color()}function te(i){var a=n.geoitems[i];e("#country-note").toggleClass("hidden",!a||!a.note),a&&a.note&&e(".bm-country-note").html(a.note)}function ie(i,a){var t=n.indicators[i],v=[];for(var l in n.geoitems){var c=n.geoitems[l];if(c.url){for(var x={label:n.geoitems[l].label,code:l},b=0;b<t.siblings.length;b++)x["value"+b]=n.indicators[t.siblings[b]].current[l];v.push(x)}}if(a){for(var E=e("#ranking").children(),j=[],_=0,p=E.length;_<p;_++)j.push(E[_].getAttribute("code"));v.sort(function(D,C){return j.indexOf(D.code)<j.indexOf(C.code)?-1:1})}else v.sort(function(H,D){return H[S]<D[S]||H[S]===void 0?-B:B});var E=e("#ranking").children();t.siblings.length==1&&t.min;for(var _=0,p=E.length;_<p;_++){var I=E[_],x=v[_],k=t.siblings.length==1?t.max:100;I.setAttribute("code",x.code),I.childNodes[0].innerHTML=x.label,x.value0==null?I.childNodes[2].innerHTML="":I.childNodes[2].innerHTML=mw.support.format(t.format,x.value0);for(var b=0;b<Q;b++){var f=I.childNodes[1].childNodes[b],T=x["value"+b];if(T==null)f.style.width=0,f.style.left=0,f.classList.remove("cropped");else{var V=Math.ceil(Math.abs(T)/k*125);f.style.width=V+"px",f.style.left=(T<0?-V:0)+"px",f.classList.toggle("cropped",Math.abs(T)>k)}}}S!="label"&&(e(".rank-indicator").removeClass("selected"),e('.rank-indicator[code="'+m+'"]').addClass("selected"))}function me(i){e(".group-indicator").each(function(){var a=n.indicators[this.getAttribute("code")],t=a.current[i],v=a.max/205;if(t==null)this.childNodes[1].style.width=0,this.childNodes[1].style.left=0,this.childNodes[2].innerHTML="";else{var l=Math.ceil(Math.abs(t)/v);this.childNodes[1].style.width=l+"px",this.childNodes[1].style.left=(t<0?-l:0)+"px",this.childNodes[2].innerHTML=mw.support.format(a.format,t)}})}function ge(i){S==e(this).val()?B*=-1:(S=e(this).val(),B=S=="label"?1:-1),ie(g,!1)}s.config.benchmarking&&s.config.benchmarking["labels-url"]&&s.config.benchmarking["labels-url"],n.listen("ready",function(){e.when(e.ajax(s.config.json+q+".json"),ee("/countries/list"),ve("benchmarking.html")).done(function(i,a,t){var v=i[0],l=a[0],c=n.meta=t[0][0];e(".drupal").each(function(){var o=c[e(this).attr("data-key")];e(this).html(o||(this.hasAttribute("data-empty")?"":"{"+e(this).attr("data-key")+"}"))});for(var x=[],b=[],j=e('<div id="map1-color"/>').appendTo("body").css("color"),_=e('<div id="map2-color"/>').appendTo("body").css("color"),p=1;p<=2;p++){var E=e("#g"+p),I=c["g"+p+"-codes"];I&&I.length?e("#indic-selector").append('<div class="bm-selector-header">'+c["g"+p+"-caption"]+"</div>"):e('[data-key="g'+p+'-caption"]').hide();for(var k in I){var f=I[k].split(","),T=c["g"+p+"-labels"][k];f.length>Q&&(Q=f.length);for(var V in f){var H=f[V],D=n.indicators[H]||{code:H,label:T,values:{}};n.indicators[H]=mw.support.extend({group:p,color:p=="1"?j:_,format:c["g"+p+"-formats"][k],description:c["g"+p+"-info"][k],grouplabel:c["g"+p+"-caption"],sort:c["g"+p+"-sort"][k]?c["g"+p+"-sort"][k].split(","):[],min:1/0,max:-1/0,siblings:f,current:{}},D),x.push(H)}var C=e("<div/>",{class:"group-indicator",code:f[0],"data-indicator":f.join(",")}).on("click",function(){e("#s123-0:not(:checked)").click(),g=e(this).attr("code"),R(g,!1)}).on("mouseenter",function(){R(e(this).attr("code"),!0)}).on("mouseleave",function(){R(g,!0)});C.append('<div class="group-label">'+T+"</div>"),C.append('<div class="group-bar" style="width: 0"></div>'),C.append('<div class="group-value"></div>'),E.append(C),e("#indic-selector").append('<div code="'+f[0]+'">'+T+"</div>"),g||(g=f[0])}}var J=new Array(Q+1);J=J.join("<div></div>");for(var W=t[0][1]["chart-countries"],fe=t[0][2]["region-inactive"],he=t[0][3]["map-inactive"],k=0,be=l.data.length;k<be;k++){var A=l.data[k],M=A.iso3||A.ISO3;v.items[M]&&(A.label=A.name,n.geoitems[M]=A)}var re=s.config.legacyasti+"/excelexport/?content=notes&lang="+z+"&countries=";for(var M in W)re+=M+",";e("#download-notes").attr("href",re);for(var M in n.geoitems){var A=n.geoitems[M];if(b.push(M),he.indexOf(M)!=-1)A.type="map-inactive";else if(fe.indexOf(M)!=-1)A.type="region-inactive";else if(W[M]){A.url=W[M];var C=e("<div/>",{class:"rank-indicator"}).on("click",function(){m=e(this).attr("code"),h.highlight(m)}).on("mouseenter",function(){h.highlight(e(this).attr("code"))}).on("mouseleave",function(){h.highlight(m)});C.append('<div class="rank-label"></div>'),C.append('<div class="rank-bar">'+J+"</div>"),C.append('<div class="rank-value"></div>'),e("#ranking").append(C),e("#geo-selector").append('<div code="'+M+'">'+A.label+"</div>")}}e("#ranking-container").height(Math.max(e("#groups").height(),e(".bm-map").height())),navigator.userAgent.indexOf("MSIE 9.0")!=-1&&e("#ranking").height(e("#groups").height()-78),h=new mw.Map("map",{map:{url:v,padding:10},data:n,layers:[new mw.map.layers.Highlight({template:pe})],zoom:!1,events:{touch:"click hover",click:!0},color:ue}),h.listen("hover",function(o){if(o){var r=n.geoitems[o.geoitem];ae(r&&r.type!="map-inactive"?o.geoitem:m)}else ae(m)}),h.listen("click",function(o){var r=n.geoitems[o.geoitem];r&&!r.type&&(m=o.geoitem,h.highlight(o.geoitem))}),e("body").on("click",'input[name="sort"]',ge),e(".bm-selector").on("mouseenter",function(){e(this).addClass("opened")}),e(".bm-selector").on("mouseleave",function(){e(this).removeClass("opened")}),e("#geo-selector").on("click","div[code]",function(o){m=e(o.target).attr("code"),h.highlight(m),e(this).closest(".bm-selector").removeClass("opened")}),e("#indic-selector").on("click","div[code]",function(o){e("#s123-0:not(:checked)").click(),g=e(o.target).attr("code"),R(g,!1),e(this).closest(".bm-selector").removeClass("opened")}),e("#data-download").on("click",function(){var o="",r="";if(e("#l2-1").prev().prop("checked"))o+="&countries[]="+m;else for(var N in n.geoitems)n.geoitems[N].url&&(o+="&countries[]="+N);if(e("#l1-1").prev().prop("checked"))r+="&indicators[]="+g;else for(var N in n.indicators)r+="&indicators[]="+N;var w=s.config.legacyasti+"/excelexport/?years=latest"+o+r;window.open(w,"_blank")}),u=e("<div/>",{class:"chart-tooltip"}).css("position","absolute").appendTo("body"),e("#ranking").on("mouseenter",".rank-bar div",function(o){if(o.target.previousSibling){for(var r=n.indicators[g],N=r.siblings,w=o.target.parentNode.parentNode.getAttribute("code"),L=0,P=o.target;P=P.previousSibling;L++);if(L<r.siblings.length){var d=n.indicators[N[L]];u.html(r.sort[L]+": "+mw.support.format(r.format,d.current[w]));var O=e(o.target).offset();u.css({left:O.left+.5*e(o.target).width(),top:O.top}).show()}}}),e("#ranking").on("mouseleave",".rank-bar div",function(o){u.hide()}),ee("/indicators/data",{indicators:x,countries:b}).done(function(o){var r=n.indicators,N=o.data.series;for(var w in N){var L=N[w].iso3||N[w].ISO3,P=N[w].results;for(var o in P){var d=P[o].indicator,O=P[o].data;r[d]&&(r[d].values[L]=O)}n.geoitems[L].note=N[w].note}for(var d in r)if(r[d].current){for(var L in r[d].values){var O=r[d].values[L],ne=-1/0;for(var F in O)O[F]=parseFloat(O[F]),F>ne&&(ne=F,r[d].current[L]=O[F])}for(var w in r[d].current)r[d].current[w]>r[d].max&&(r[d].max=r[d].current[w]),r[d].current[w]<r[d].min&&(r[d].min=r[d].current[w])}for(var d in r)c["indicator-limits"]&&c["indicator-limits"][d]&&(r[d].max=+c["indicator-limits"][d]);h.highlight(m),R(g,!1)})})})})}),[]}class Oe extends we{constructor(s){super(),xe(this,s,Ce,ze,ye,{})}}export{Oe as component};
